<html>
<body>
<LINK REL="stylesheet" type="text/css" HREF="../default.css">
<H1>On Socklisten</H1>
<br>
<br>
The <b>ON SOCKLISTEN</b> event triggers when a connection is made on a listening {{mIRC|sockets#mIRC sockets|TCP socket}} created with {{mIRC|/socklisten}}

<H4>Synopsis</H4>
<pre>ON &lt;level&gt;:SOCKLISTEN:&lt;matchtext&gt;:&lt;commands&gt;</pre>

<H4>Parameters</H4>
'''&lt;matchtext&gt;'''</span>The name of the socket you want event to trigger on.

<br><b>&lt;commands&gt;</b> - The commands to be performed when the event listener's criteria is met.

== Accepting a connection ==

'''Note''': By design, you cannot prevent a socket from being accepted, as in, Windows accepts the connection even before mIRC.

You can use /sockaccept <newsocket> to accept a socket, mIRC create the new socket.

'''Note''': If a new connection occurs on a listening socket but there is no on socklisten event matching that socket, the connection is rejected.

You should be checking for $sockerr before accepting the connection to see if an error occured, here is a list of the possible value for $sockerr in the on SOCKLISTEN event:

* '''0''' - New socket successfuly accepted.
* '''1''' - Error occurred on listening socket, $sock().wsmsg will contain a more specific error message. Note that getting this error is considered rare.
* '''2''' - Error accepting new socket, $sock().wsmsg will contain a more specific error message.
* '''4''' - Not enough memory for new socket. Note that getting this error is considered rare.

== Examples ==

<pre class ="code">
on *:socklisten:name:{
  if (!$sockerr) sockaccept myprefix $+ $ticks
  else {
    echo -s An error occured while trying to accept a connection: $sock($sockname).wsmsg
  }
}
</pre>

<H4>Compatability</H4>
{{mIRC compatibility|3.5}}

== See Also ==
* {{mIRC|on events|mIRC events}}
* {{mirc|on events/on sockopen|on sockopen}}
* {{mirc|on events/on sockread|on sockread}}
* {{mirc|on events/on sockwrite|on sockwrite}}
* {{mirc|on events/on sockclose|on sockclose}}
* {{mIRC|/sockwrite}}
* {{mIRC|/sockclose}}
* {{mIRC|/sockread}}
* {{mIRC|/sockaccept}}
* {{mIRC|/sockpause}}
* {{mIRC|$sock}}
* {{mIRC|$sockbr}}
* {{mIRC|$sockerr}}

[[Category:mIRC on events|socklisten]]</body>
</html>
