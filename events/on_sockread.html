<html>
<body>
<LINK REL="stylesheet" type="text/css" HREF="../default.css">
<H1>On Sockread</H1>
<br>
<br>
The <b>ON SOCKREAD</b> triggers when there is info waiting to be read on the specified TCP socket connection. You can read this info using the <a href="..\commands\sockread.html">/sockread</a><br> command.

'''Note''': If this event triggers but no <a href="..\commands\sockread.html">/sockread</a><br> is performed to attempt to read the buffer, it is assumed that no script exists that is handling this buffer, so it is cleared and the info it contained is lost.

<H4>Synopsis</H4>
<pre class = "code">ON &lt;level&gt;:SOCKREAD:&lt;matchtext&gt;:&lt;commands&gt;</pre>

<H4>Parameters</H4>
<br><b>&lt;matchtext&gt;</b> - The name of the socket you want the event to trigger on.

<br><b>&lt;commands&gt;</b> - The commands to be performed when the event listener's criteria is met.

== Connection State ==

It's important to check the value of <a href="..\identifiers\sockerr.html">$sockerr</a><br> to determine if any connection errors occurred and handle that case. Here is a list of possible values returned by $sockerr in the on SOCKREAD event:

* '''0''' - Data received correctly.
* '''3''' - Error occurred on connected socket: $sock($sockname).wsmsg will contain a more specific error message.

<H4>Example</H4>

You can find more information and examples in the <a href="..\commands\sockread.html">/sockread</a><br> command page.

Here is a basic outline:
<pre class ="code">
on *:sockread:example:{

  ;if an error occurred ($sockerr is not 0)
  if ($sockerr) {
    echo -s An error occurred: $sock($sockname).wsmsg
  }

  ;no error occurred ($sockerr was 0)
  else {

    ;perform commands related to reading the data

    ;declare %r as a local variable for use in /sockread
    var %r

    ;read a line into %r from the buffer (this variable is subject to mIRC's Line Length Limit - see the /sockread page for more information)
    sockread %r

    ;do things with %r, such as checking its value or extracting parts to output later

  }
}
</pre>

<H4>Compatability</H4>
Added: mIRC v3.5 (07 Aug 1995)

<H4>See also</H4>
* <a href="On_SockOpen.html">On_SockOpen</a><br>
* <a href="On_SockWrite.html">On_SockWrite</a><br>
* <a href="On_SockListen.html">On_SockListen</a><br>
* <a href="On_SockClose.html">On_SockClose</a><br>
* {{mIRC|/sockopen}}
* <a href="..\commands\sockwrite.html">/sockwrite</a><br>
* <a href="..\commands\sockread.html">/sockread</a><br>
* <a href="..\commands\sockclose.html">/sockclose</a><br>
* <a href="..\commands\sockaccept.html">/sockaccept</a><br>
* <a href="..\commands\sockpause.html">/sockpause</a><br>
* {{mIRC|$sockname}}
* <a href="..\identifiers\sock.html">$sock</a><br>
* <a href="..\identifiers\sockbr.html">$sockbr</a><br>
* <a href="..\identifiers\sockerr.html">$sockerr</a><br>

</body>
</html>
