<html>
<body>
<LINK REL="stylesheet" type="text/css" HREF="../default.css">
<head><title>$com</title></head>
<H1>$com</H1>
<br>
<br>
The <b>$com</b> calls a member of an open COM connection with the specified method and parameter, or returns informations about a currently opened COM or returns the value of the specified variable name

<H4>Synopsis</H4>
<pre class ="code">
$com(name,member,method,type1,value1,...,typeN,valueN) - calls a member of an open COM connection with the specified method and parameters, returns 1 if the call succeeds, 0 = fail.
$com(name/N,varname) - returns the value of the specified variable name
$com(name/N) - returns the name of the Nth open COM connection or the name of that connection if it's open
</pre>

<H4>Parameters</H4>
<b>name/N</b> - The name of the connection or the Nth connection
<br><b>varname</b> - The name of a variable previously saved
<br><b>member</b> - The name of the function of the object
<br><b>method</b> - A combination of the following value added together:

<br><b>1 </b> DISPATCH_METHOD - Call a member of an object
<br><b>2 </b> DISPATCH_PROPERTYGET - Return a value
<br><b>3 </b> (1+2) Call a member and return a value *
<br><b>4 </b> DISPATCH_PROPERTYPUT - Set a property
<br><b>5 </b> (1+4) Set a property with a member call *
<br><b>6 </b> (2+4) Set a property and return a value *
<br><b>7 </b> (1+2+4) Set a property and return a value with a member call *
<br><b>8 </b> DISPATCH_PROPERTYPUTREF - Set a property by reference
<br><b>9 </b> (1+8) Set a property by reference with a member call *
<br><b>10</b> (2+8) Set a property by reference and return a value *

<br><b>type1</b> - The variable type, can be:
<br><b>|i1</b> single byte signed integer || 0 to 225
<br><b>|ui1</b> single byte unsigned integer || 0 to 255
<br><b>|i2</b> two byte signed integer || -32768 to 32767
<br><b>|ui2</b> two byte unsigned integer || 0 to 65535
<br><b>|i4</b> four byte signed integer || +/- 2147483647
<br><b>|ui4</b> Holds unsigned 32-bit (4-byte) integers || 0 through 4,294,967,295
<br><b>|int</b> integer || -2147483648 to 2147483647
<br><b>|uint</b> unsigned integer || 0 to 4294967295
<br><b>|r4</b> real, 4-byte floating point number || 1.17549435E-38 to 3.40282347E+38
<br><b>|r8</b> double real, 8-byte floating point number || 2.2250738585072014E-308 - 1.7976931348623157E+308
<br><b>|cy</b> eight byte curreny number || -922337203685477.5625 to 922337203685477.5625
<br><b>|date</b> contains date and time, stored as an 8-byte floating-point number || +/-79,228,162,514,264,337,593,543,950,335
<br><b>|decimal</b> Holds signed 128-bit (16-byte) values representing 96-bit (12-byte) integer numbers. || +/-79,228,162,514,264,337,593,543,950,335
<br><b>|bool</b> contain any string or numeric representation.
<br><b>|bstr</b> null-terminated unicode character string value. || A string can contain from 0 to approximately 2 billion (2^31) Unicode characters.
<br><b>|variant</b>can contain string, date, time, boolean, or numeric values. When used, a data type must follow it: for example: variant int 5
<br><b>|dispatch</b>  This data type indicates a pointer to an IDispatch interface on an OLE object (DBTYPE_IDISPATCH).
<br><b>|unknown</b> This data type indicates a pointer to an IUnknown interface on an OLE object (DBTYPE_IUNKNOWN).
<br><b>|error</b> This data type indicates a 32-bit error code (DBTYPE_ERROR)

<br>
<br>

You can pass a binary variable by prefixing the type of the variable with an '&' sign eg. $com(name,member,method,&bstr &binvar)
<br>
To make a variable by reference, postfix the data type with an asterisk and a variable name, for example: int* pIntOfBeer.
<br>
<br><b>value1</b> - the value assigned to the variable type

<H4>Properties</H4>
When only one parameter is passed to $com (name/N), you can use the following properties:
<br><b>.progid</b> - returns the object name
<br><b>.result</b> - returns the value returned by the COM object member call, you can save this result to a binary variable with $com(name/N,&binvar).result
<br><b>.error</b> - returns the error value, if there were any error
<br><b>.errortext</b> - returns the error description associated with the '''.error''' value
<br><b>.argerr</b> - returns the Nth argument that caused the error, if the error were due to an invalid variable type.
<br><b>.dispatch</b> - returns the name of the dispatched pointer if it exist
<br><b>.unknown</b> - returns the name of the unknown pointer if it exist
<br><b>.inuse</b> - returns $true if the current com connection is in use

In the case of retrieving an unknown pointer, mIRC will extend it to a dispatch pointer if it can, allowing you to call it directly via $com().

<H4>Example</H4>
<pre class ="code"></pre>

<H4>Compatibility</H4>
Added: mIRC v5.9 (26 Apr 2001)

<H4>Notes</H4>
None
<H4>See also</H4>
<a href="comval.html">$comval</a><br>
<a href="comerr.html">$comerr</a><br>
<a href="..\commands\comopen.html">/comopen</a><br>
<a href="..\commands\comclose.html">/comclose</a><br>
</body>
</html>
