<html>
<body>
<LINK REL="stylesheet" type="text/css" HREF="../default.css">
<head><title>$comcall</title></head>
<H1>$comcall</H1>
<br>
<br>
The <b>$comcall</b> identifier calls a member of an open COM connection with the specified method and parameter, it is multithreaded and won't halt the script, an alias is called once the call returns.

If $comcall() fails when calling an object and $com() does not, this means that the object is not compatible with the threading model of mIRC, so $com() must be used. You can check the $comerr value in the alias to determine if a $comcall() failed or not.

<H4>Synopsis</H4>
<pre class ="code">
$comcall(name,alias,member,method,type1,value1,...,typeN,valueN)
</pre>

<H4>Parameters</H4>
<b>name</b> -The name of the connection or the Nth connection
<br><b>alias</b> - The name of an alias that will be called once the call returns
<br><b>member</b> - The name of the function of the object
<br><b>method</b> - A combination of the following value added together:

<br><b>1 </b> DISPATCH_METHOD - Call a member of an object
<br><b>2 </b> DISPATCH_PROPERTYGET - Return a value
<br><b>3 </b> (1+2) Call a member and return a value *
<br><b>4 </b> DISPATCH_PROPERTYPUT - Set a property
<br><b>5 </b> (1+4) Set a property with a member call *
<br><b>6 </b> (2+4) Set a property and return a value *
<br><b>7 </b> (1+2+4) Set a property and return a value with a member call *
<br><b>8 </b> DISPATCH_PROPERTYPUTREF - Set a property by reference
<br><b>9 </b> (1+8) Set a property by reference with a member call *
<br><b>10</b> (2+8) Set a property by reference and return a value *
<br>
<br>
<br><b>type1</b> - The variable type, can be:
<br>
<br><b>i1</b> single byte signed integer || 0 to 225
<br><b>ui1</b> single byte unsigned integer || 0 to 255
<br><b>i2</b> two byte signed integer || -32768 to 32767
<br><b>ui2</b> two byte unsigned integer || 0 to 65535
<br><b>i4</b> four byte signed integer || +/- 2147483647
<br><b>ui4</b> Holds unsigned 32-bit (4-byte) integers || 0 through 4,294,967,295
<br><b>int</b> integer || -2147483648 to 2147483647
<br><b>uint</b> unsigned integer || 0 to 4294967295
<br><b>r4</b> real, 4-byte floating point number || 1.17549435E-38 to 3.40282347E+38
<br><b>r8</b> double real, 8-byte floating point number || 2.2250738585072014E-308 - 1.7976931348623157E+308
<br><b>cy</b> eight byte curreny number || -922337203685477.5625 to 922337203685477.5625
<br><b>date</b> contains date and time, stored as an 8-byte floating-point number || +/-79,228,162,514,264,337,593,543,950,335
<br><b>decimal</b> Holds signed 128-bit (16-byte) values representing 96-bit (12-byte) integer numbers. || +/-79,228,162,514,264,337,593,543,950,335
<br><b>bool</b> contain any string or numeric representation.
<br><b>bstr</b> null-terminated unicode character string value. || A string can contain from 0 to approximately 2 billion (2^31) Unicode characters.
<br><b>variant</b>can contain string, date, time, boolean, or numeric values. When used, a data type must follow it: for example: variant int 5
<br><b>dispatch</b>  This data type indicates a pointer to an IDispatch interface on an OLE object (DBTYPE_IDISPATCH).
<br><b>unknown</b> This data type indicates a pointer to an IUnknown interface on an OLE object (DBTYPE_IUNKNOWN).
<br><b>error</b> This data type indicates a 32-bit error code (DBTYPE_ERROR)

You can pass a binary variable by prefixing the type of the variable with an '&' sign eg. $com(name,member,method,&bstr &binvar)

To make a variable by reference, postfix the data type with an asterisk and a variable name, for example: int* pIntOfBeer.

<br><b>value1</b> - the value assigned to the variable type

<H4>Properties</H4>
None

<H4>Example</H4>
<pre class ="code">
alias runVbs {
  var %s = $mircdir $+ foo.vbs
  write -c foo.vbs  Dim c $lf c = 0 $lf Do While c < 10000000 $lf c = c + 1 $lf Loop
  .comopen x WScript.Shell

  ;mode 1 = comcall
  if ($1 == 1) noop $comcall(x, cbthread, Run, 1, bstr*, %s, int, 1, bool, 1)
  else {
    noop $com(x,  Run, 1, bstr*, %s, int, 1, bool, 1)
    .comclose x
  }
}
alias cbthread echo -a done | .comclose x
</pre>Compare //var %t $ticks | runvbs 1 | echo -a $calc($ticks - %t) vs //var %t $ticks | runvbs 2 | echo -a $calc($ticks - %t)

<H4>Compatibility</H4>
Added: mIRC v5.9 (26 Apr 2001)

<H4>Notes</H4>
None
<H4>See also</H4>
<a href="comval.html">$comval</a><br>
<a href="comerr.html">$comerr</a><br>
<a href="..\commands\comopen.html">/comopen</a><br>
<a href="..\commands\comclose.html">/comclose</a><br>
</body>
</html>
