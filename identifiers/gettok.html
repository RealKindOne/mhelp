<html>
<body>
<LINK REL="stylesheet" type="text/css" HREF="../default.css">
<head><title>$gettok</title></head>
<H1>$gettok</H1>
<br>
<br>
The <b>$gettok</b> identifier returns the Nth $asc(C)-delimited token from a list.

<H4>Synopsis</H4>
<pre class ="code">
$gettok(&lt;LIST&gt;,&lt;N-N2&gt;,&lt;C&gt;)
</pre>
<H4>Parameters</H4>
<b>LIST</b> - Text list delimited by a character into tokens<br />
<br><b>N-N2</b> - The token(s) to be returned.<br />
<br><b>C</b> - The <a href="asc.html">$asc</a> value which splits TEXT into tokens<br />
<br>
If you pass $null for <b>N-N2</b>, $null is returned.
If you pass a single number N, it represents a single token to retrieve, passing 0 will return the number of token, same as <a href="numtok.html">$numtok</a><br>, passing N greater than the number of token returns $null
Otherwise, it's a range of tokens to retrieve, in the format N-N2:
-Both N and N2 can be negative, in this case the position they refer to starts from the end of the string instead. $gettok(a b c d e f g,-3--5,32) will get the tokens from position -5 (c) to position -3 (e) resulting in "c d e"
-N2 can be smaller than N, $gettok will work it out: $gettok(string,2-1,C) = $gettok(string,1-2,C)
-If the lower bound is greater than the number of tokens, $null is returned $gettok(a b,3-4,32)
-If the upper bound is greater than the number of tokens, it gets all tokens starting from the lower bound onward, $gettok(a b c,2-5,32) = $gettok(a b c,2-3,32) = "b c"
-N2 is optional, $gettok(string,N-,C) will gets all tokens onward, starting at the Nth position.
-The character '-' used to separate the two numbers can be spaced out <b>N - N2</b>, no need to use $+ to build dynamic ranges.

Note: if you need to get everything but the last token, $gettok(,1--2,32) will return the first token when only one token is there: $gettok(a b,1--2,32) is "a" but $gettok(a,1--2,32) is "a" again, not $null, if you need $null, use $deltok(string,-1,C).


  
<H4>Properties</H4>
None

<H4>Example</H4>

Echo to the active window, the 2nd token as delimited by the $chr(45) hyphen:
<pre class ="code">
; returns b
//echo -a $gettok(a-b-c-d-e,2,45)
</pre>

$chr(32) is the space character. Echo the current month to the active window:
//echo -a The current month is $gettok($asctime,2,32)

This returns ''Mon Tue'' because the space between %x %y becomes the 2nd delimiter:
//var %x Sun Mon | var %y Tue Wed Thu Fri Sat | echo -a $gettok(%x %y,2-3,32)
<br>
$chr(58) is the colon, $chr(92) is the backslash:
<pre class ="code">
//echo -a This $gettok($mircexe,-1,92) is installed on the $gettok($mircexe,1,58) drive letter in a program folder named $gettok($mircexe,-2,92)
//var %i $gettok($mircexe,0,92) | echo -a $gettok($mircexe,1- $+ $calc(%i -1) ,92) is mIRC's path without the ending backslash
</pre>

<pre class ="code">
//echo -a $gettok(Sun.Mon.Tue.Wed.Thu.Fri.Sat,2-4,46)
; returns Mon.Tue.Wed (including the delimiter period between the returned tokens
//echo -a $gettok(Sun.Mon.Tue.Wed.Thu.Fri.Sat,3-,46)
; returns all tokens beginning with the 3rd: Tue.Wed.Thu.Fri.Sat

//echo -a $gettok(11x22x33x44,3,120)
; returns 33 because $chr(120) is lower-case x
//echo -a $gettok(x11xxxx22x33x44x,3,120)
; also returns 33 because duplicate, leading, and trailing delimiters are stripped before $gettok processes the TEXT
//echo -a $gettok(11x22X33x44,3,120)
; returns 44 because the C token is case-sensitive, so capital X isn't a delimiter

$gettok allows the range numbers to be negative
//echo -a $gettok(Sun.Mon.Tue.Wed.Thu.Fri.Sat,-4- $+ -2,46)
; returns the 4th-from-last through 2nd-from-last tokens
//echo -a $gettok(Sun.Mon.Tue.Wed.Thu.Fri.Sat,-2-,46)
; returns the last 2 tokens
//echo -a $gettok(Sun.Mon.Tue.Wed.Thu.Fri.Sat,2- $+ -2,46)
; returns 2nd token through 2nd-from-last token


$gettok puts range numbers in the correct order before evaluating them.
//echo -a $gettok(Sun.Mon.Tue.Wed.Thu.Fri.Sat,4-3,46)
; returns same results as if range 3-4 were used
//echo -a $gettok(Sun.Mon.Tue.Wed.Thu.Fri.Sat,-4-3,46)
; returns 4th-from-last token thru the 3rd token regardless whether the 3rd token is the earlier or later token in the list.
</pre>

<br><b>Note:</b>$gettok differs from CSV format in that it does not use double-quotes to allow a delimiter to be part of another token. If you want $filename to be a token in a comma-delimited list of tokens, you should use {{mIRC|$replace|$replace}} to change the comma in the filename into another character that cannot appear in the filename before adding as a token, then use {{mIRC|$replace|$replace}} on the extracted token to restore any comma(s). Alternatively use a character other than a comma (like '|') as a delimiter instead.

<H4>Compatibility</H4>
Added: mIRC v4.7 (09 Dec 1996)

<H4>Notes</H4>
None
<H4>See also</H4>

<a href="addtok.html">$addtok</a><br>
<a href="deltok.html">$deltok</a><br>
<a href="findtok.html">$findtok</a><br>
<a href="instok.html">$instok</a><br>
<a href="istok.html">$istok</a><br>
<a href="matchtok.html">$matchtok</a><br>
<a href="numtok.html">$numtok</a><br>
<a href="puttok.html">$puttok</a><br>
<a href="remtok.html">$remtok</a><br>
<a href="reptok.html">$reptok</a><br>
<a href="sorttok.html">$sorttok</a><br>
<a href="wildtok.html">$wildtok</a><br>
</body>
</html>
